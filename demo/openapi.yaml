openapi: 3.0.2
info:
  version: v1
  title: Te Rito APIs
  description: "<p>Derived from SIF Data Model (New Zealand) v3.2 (rc2)</p>
    <p><strong>Release Date: </strong>04-Sep-2020</p>"
  contact:
    name: Ministry of Education
    url: http://www.terito.govt.nz
    email: terito@education.govt.nz
servers:
  - url: https://{host}.edsby.co.nz/{basePath}
    description: The demonstration Te Rito server
    variables:
      host:
        default: southern
        description: southern.edsby.co.nz is the default demonstration platform
      basePath:
        default: sif
security:
  - sifDataObject:
      - sysadmin
      - TERITO_SMS
  - devt: []
paths:
  "/provider/{providerRefId}/StaffPersonal":
    post:
<<<<<<< HEAD
      summary: Default operation to create one or more StaffPersonal entries
      security:
        - sifDataObject:
            - sysadmin
=======
      tags:
        - pet
      summary: Add a new pet to the store
      description: Add new pet to the store inventory.
      operationId: addPet
      responses:
        '405':
          description: Invalid input
      security:
        - petstore_auth:
            - 'write:pets'
            - 'read:pets'
      x-codeSamples:
        - lang: 'C#'
          source: |
            PetStore.v1.Pet pet = new PetStore.v1.Pet();
            pet.setApiKey("your api key");
            pet.petType = PetStore.v1.Pet.TYPE_DOG;
            pet.name = "Rex";
            // set other fields
            PetStoreResponse response = pet.create();
            if (response.statusCode == HttpStatusCode.Created)
            {
              // Successfully created
            }
            else
            {
              // Something wrong -- check response for errors
              Console.WriteLine(response.getRawResponse());
            }
        - lang: PHP
          source: |
            $form = new \PetStore\Entities\Pet();
            $form->setPetType("Dog");
            $form->setName("Rex");
            // set other fields
            try {
                $pet = $client->pets()->create($form);
            } catch (UnprocessableEntityException $e) {
                var_dump($e->getErrors());
            }
      requestBody:
        $ref: '#/components/requestBodies/Pet'
    put:
      tags:
        - pet
      summary: Update an existing pet
      description: ''
      operationId: updatePet
      responses:
        '400':
          description: Invalid ID supplied
        '404':
          description: Pet not found
        '405':
          description: Validation exception
      security:
        - petstore_auth:
            - 'write:pets'
            - 'read:pets'
      x-codeSamples:
        - lang: PHP
          source: |
            $form = new \PetStore\Entities\Pet();
            $form->setPetId(1);
            $form->setPetType("Dog");
            $form->setName("Rex");
            // set other fields
            try {
                $pet = $client->pets()->update($form);
            } catch (UnprocessableEntityException $e) {
                var_dump($e->getErrors());
            }
      requestBody:
        $ref: '#/components/requestBodies/Pet'
  '/pet/{petId}':
    get:
      tags:
        - pet
      summary: Find pet by ID
      description: Returns a single pet
      operationId: getPetById
      parameters:
        - name: petId
          in: path
          description: ID of pet to return
          required: true
          deprecated: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Pet'
            application/xml:
              schema:
                $ref: '#/components/schemas/Pet'
        '400':
          description: Invalid ID supplied
        '404':
          description: Pet not found
      security:
        - api_key: []
    post:
      tags:
        - pet
      summary: Updates a pet in the store with form data
      description: ''
      operationId: updatePetWithForm
>>>>>>> master
      parameters:
        - $ref: "#/components/parameters/syncOverride"
      operationId: createStaffPersonals
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                StaffPersonals:
                  $ref: jsonSchema.NZ.create.yaml#/properties/StaffPersonals
            example:
              StaffPersonals:
                StaffPersonal:
                  - StaffPersonalRefId: D3E34F41-9D75-101A-8C3D-00AA001A1652
                    StaffPersonalLocalId: ST-001
                    PersonInfo:
                      Name:
                        FamilyName: Smith
                        GivenName: Fred
                        FullName: Fred Smith
                        IsVerified: N
                      Demographics:
                        BirthDate: 1966-05-01
                      EmailList:
                        Email:
                          Type: PRIM
                          Address: freddy@gmail.com
                  - StaffPersonalRefId: D3E34F41-9D75-101A-8C3D-00AA001b3652
                    StaffPersonalLocalId: ST-002
                    PersonInfo:
                      Name:
                        FullName: Fred Jones
                        IsVerified: N
                      Demographics:
                        BirthDate: 1966-05-01
                      EmailList:
                        Email:
                          - Type: PRIM
                            Address: fredJ@gmail.com
          application/xml:
            schema:
              type: object
              properties:
                StaffPersonals:
                  $ref: jsonSchema.NZ.create.yaml#/properties/StaffPersonals
            example: >-
              <StaffPersonals>
                <StaffPersonal>
                  <StaffPersonalRefId>D3E34F41-9D75-101A-8C3D-00AA001A1652</StaffPersonalRefId>
                  <StaffPersonalLocalId>ST-001</StaffPersonalLocalId>
                  <PersonInfo>
                    <Name>
                      <FamilyName>Smith</FamilyName>
                      <GivenName>Fred</GivenName>
                      <FullName>Fred Smith</FullName>
                      <IsVerified>N</IsVerified>
                    </Name>
                    <Demographics>
                      <BirthDate>1966-05-01</BirthDate>
                    </Demographics>          
                    <EmailList>
                      <Email>
                        <Type>PRIM</Type>
                        <Address>freddy@gmail.com</Address>
                      </Email>
                    </EmailList>
                  </PersonInfo>
                </StaffPersonal>
                <StaffPersonal>
                  <StaffPersonalRefId>D3E34F41-9D75-101A-8C3D-00AA001b3652</StaffPersonalRefId>
                  <StaffPersonalLocalId>ST-002</StaffPersonalLocalId>
                  <PersonInfo>
                    <Name>
                      <FullName>Fred Jones</FullName>
                      <IsVerified>N</IsVerified>
                    </Name>
                    <Demographics>
                      <BirthDate>1966-05-01</BirthDate>
                    </Demographics>          
                    <EmailList>
                      <Email>
                        <Type>PRIM</Type>
                        <Address>fredJ@gmail.com</Address>
                      </Email>
                    </EmailList>
                  </PersonInfo>
                </StaffPersonal>      
              </StaffPersonals>
      responses:
        "201":
          description: All objects created
          content:
            application/json:
              schema:
                type: object
                properties:
                  StaffPersonals:
                    $ref: jsonSchema.NZ.create.yaml#/properties/StaffPersonals
              example:
                $ref: "#/paths/~1provider~1%7BproviderRefId%7D~1StaffPersonal/post/\
                  requestBody/content/application~1json/example"
            application/xml:
              schema:
                type: object
                properties:
                  StaffPersonals:
                    $ref: jsonSchema.NZ.create.yaml#/properties/StaffPersonals
              example:
                $ref: "#/paths/~1provider~1%7BproviderRefId%7D~1StaffPersonal/post/\
                  requestBody/content/application~1xml/example"
        default:
          description: Some objects created, some objects failed
          content:
            application/json:
              schema:
                type: array
                items:
                  anyOf:
                    - type: object
                      title: Error
                      properties:
                        Error:
                          $ref: "#/components/error"
                    - type: object
                      title: StaffPersonal
                      properties:
                        StaffPersonal:
                          $ref: jsonSchema.NZ.create.yaml#/properties/StaffPersonal
  "/Organisation/{OrganisationsRefId}":
    get:
      summary: Default operation to get a single Organisation
      operationId: getOrganisation
      parameters:
        - name: fields
          in: query
          description: Return only specified fields	`fields=name,nid`
          schema:
            type: string
        - name: page
          in: query
          description: Return nth page of results; default 0	`page=2`; applies to any call
            with repeated data
          schema:
            type: integer
            minimum: 0
        - name: max
          in: query
          description: Maximum items per page, default 10,000; `max=100`; applies to any
            call with repeated data
          schema:
            type: integer
            minimum: 1
        - name: unwrap
          in: query
          description: Remove top level wrapper from json results in single result
            reponses;	`unwrap=1`
          schema:
            enum:
              - 0
              - 1
              - 2
        - name: human
          in: query
          description: For code set fields, translate code to human readable form;	`human=1`
          schema:
            enum:
              - 0
              - 1
        - name: start
          in: query
          description: Include only items from start date;	`start=2017-01-01`
          schema:
            type: string
            format: date
        - name: end
          in: query
          description: Include only items before end date;	`end=2017-08-31`
          schema:
            type: string
            format: date
        - name: sort
          in: query
          description: Sort results by specified field;	`sort=FamilyName`
          schema:
            type: string
        - name: field
          in: query
          description: Field to filter on when used with **pattern**;	`field=FamilyName`
          schema:
            type: string
        - name: pattern
          in: query
          description: Filter results using pattern on **field**; `pattern=Sco*`
          schema:
            type: string
        - name: OrganisationRefId
          in: path
          description: The Ministry of Education Organisation Id of the Provider; used to
            limit the scope of the API endpoint to a particular MoE
            Organisation.
          schema:
            type: string
            pattern: ^[1-9][0-9]{0,4}$
        - name: OrganisationRefId
          in: path
          description: <p>The SIF GUID used by systems to identify the organisation.</p>
          required: true
          schema:
            type: string
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  Organisation:
                    $ref: jsonSchema.NZ.create.yaml#/properties/Organisation
              example:
                Organisation:
                  AddressList: {}
                  CommunicationChannelList: {}
                  ContactList:
                    Contact:
                      Name:
                        FamilyName: Dumbledore
                        GivenName: Albus
                        FullName: Albus Dumbledore
                      PositionTitle: Lead School Headmaster
                      Role: PRI
                      AddressList:
                        Address:
                          Type: TH
                          Role: PHY
                          Street:
                            Line1: 533 Hogwart's Way
                          City: Hogsmead
                          PostalCode: "7733"
                      EmailList: {}
                      PhoneNumberList: {}
                  EmailList:
                    Email:
                      - Type: PRIM
                        Address: stuart@gmail.com
                  LocationList: {}
                  Name: Masterton (Whakaoriori) KÄhui Ako
                  PhoneNumberList:
                    PhoneNumber:
                      Notes: Lead School Secretary (Mobile)
                      Type: MOB
                      Number: (021) 300 999
                  Type: 998
                  OrganisationRefId: D3E34B35-9D75-101A-8C3D-00AA001A1652
                  OrganisationLocalId: 99204
        default:
          description: Failed to retrieve object(s).
          content:
            application/json:
              schema:
                type: object
                title: error
                required:
                  - error
                  - when
                  - errorstr
                additionalProperties: false
                properties:
                  error:
                    type: integer
                    description: Edsby defined error code
                  when:
                    type: string
                    format: date-time
                    description: Date and Time of when the HTTP request was processed.
                  errorstr:
                    type: string
                    description: Narrative text describing the error
                  refId:
                    type: string
                    description: Data object refId of the object being created/updated
                  localId:
                    type: string
                    description: Data object localId of the object being created/updated
              example:
                error: 1009
                when: 2020-07-16 20:00:46
                errorstr: "Bad field: PersonInfo-Name-FamilyName: missing required field
                  PersonInfo-Name-FamilyName (LastName) 'None'"
                localId: ST-002
            application/xml:
              schema:
                type: object
                title: error
                required:
                  - error
                  - when
                  - errorstr
                additionalProperties: false
                properties:
                  error:
                    type: integer
                    description: Edsby defined error code
                  when:
                    type: string
                    format: date-time
                    description: Date and Time of when the HTTP request was processed.
                  errorstr:
                    type: string
                    description: Narrative text describing the error
                  refId:
                    type: string
                    description: Data object refId of the object being created/updated
                  localId:
                    type: string
                    description: Data object localId of the object being created/updated
              example: >-
                <Error>
                  <error>1009</error>
                  <when>2020-07-16 20:00:46</when>
                  <errorstr>Bad field: PersonInfo-Name-FamilyName: missing required field PersonInfo-Name-FamilyName (LastName) 'None'</errorstr>
                  <localId>ST-002</localId>
                </Error>
  "/Enrolment/{EnrolmentRefId}":
    get:
      summary: Default operation to get a OrganisationStudentEnrolment
      operationId: getEnrolment
      parameters:
        - name: EnrolmentRefId
          in: path
          description: <p>The SIF GUID used by systems to identify the enrolment.</p>
          required: true
          schema:
            type: string
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  Enrolment:
                    $ref: jsonSchema.NZ.create.yaml#/properties/StudentProviderEnrolment
              example:
                StudentProviderEnrolment:
                  StudentProviderEnrolmentLocalId: 2020_8001_ST1000001
                  Student:
                    LocalId: ST1000001
                    NationalStudentNumber: 9001000001
                  Provider:
                    RefId: "8001"
                  StudentId: ST1000001
                  EntryDate: 2015-03-07
                  Status: ACT
                  ECEEducationHistoryList:
                    ECEType:
                      - Type: EPG
                  SchoolEnrolmentList:
                    SchoolEnrolment:
                      - SchoolCalendarYear: 2020
                        StartDate: 2020-01-27
                        MembershipType: BASE
                        YearLevel: 6
                        FTE: 1
                        FundingType: SF
                        FundingYearLevel: 6
                        Curriculum: NZC
        default:
          $ref: "#/paths/~1Organisation~1%7BOrganisationsRefId%7D/get/responses/def\
            ault"
  "/OrganisationRelationship/{OrganisationRelationshipRefId}":
    get:
      summary: Default operation to get a single OrganisationRelationship
      operationId: getOrganisationReln
      parameters:
        - name: OrganisationRelationshipRefId
          in: path
          description: <p>The SIF GUID used by systems to identify the organisation.</p>
          required: true
          schema:
            type: string
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  Organisation:
                    $ref: jsonSchema.NZ.create.yaml#/properties/OrganisationRelationship
              example:
                OrganisationRelationship:
                  OrganisationRelationshipLocalId: 90100_8001
                  Status: A
                  RelationshipType: "34037"
                  SourceOrganisation:
                    RefId: "90100"
                  SourceOrganisationRole: LSC
                  SourceOrganisationAgreementDate: 2020-01-15
                  RelatedOrganisation:
                    RefId: "8001"
                  RelatedOrganisationRole: "184000"
                  RelatedOrganisationAgreementDate: 2020-01-15
                  EffectiveDate: 2020-01-15
        default:
          $ref: "#/paths/~1Organisation~1%7BOrganisationsRefId%7D/get/responses/def\
            ault"
  /Search:
    get:
      tags:
        - Search
      summary: Search for Staff and Students
      description: >-
        Search operation returning partial <a
        href="#tag/StaffPersonal">StaffPersonal</a>

        and <a href="#tag/StudentPersonal">StudentPersonal</a> objects.
      operationId: search
      security:
        - sifDataObject:
            - FIRST
            - SUPS
            - SMS
      parameters:
        - name: objects
          title: objects
          type: string
          in: query
          description: "CSV delimited list of data object names; limits the search to only
            some data objects: staffpersonal, studentpersonal"
          schema:
            type: string
        - name: pattern
          title: pattern
          type: string
          in: query
          description: Select objects where search index includes the given pattern
            pattern; `pattern=Sco*`
          schema:
            type: string
        - name: query
          title: query
          type: string
          in: query
          description: Use lucene query language to select objects;
          schema:
            type: string
        - name: max
          in: query
          description: Maximum items per page, default 10,000; `max=100`; applies to any
            call with repeated data
          schema:
            type: integer
            minimum: 1
        - name: page
          in: query
          description: Return nth page of results; default 0	`page=2`; applies to any call
            with repeated data
          schema:
            type: integer
            minimum: 0
        - name: human
          in: query
          description: For code set fields, translate code to human readable form;	`human=1`
          schema:
            enum:
              - 0
              - 1
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  Search:
                    type: object
                    properties:
                      Summary:
                        type: object
                        description: Statistical summary of the search results returned.
                        properties:
                          Shown:
                            type: integer
                            description: Count of objects returned in this response
                          More:
                            type: integer
                            description: Count of objects yet to be returned, because of
                              `max` page size limit
                      SearchResults:
                        type: object
                        description: The data objects found
                        properties:
                          Personals:
                            type: object
                            description: Staff &amp; Student Personal objects found
                            properties:
                              StaffPersonals:
                                type: object
                                description: StaffPersonal objects found
                                properties:
                                  StaffPersonal:
                                    type: array
                                    items:
                                      type: object
                                      properties:
                                        Name:
                                          type: string
                                          description: Full name from the search index
                                        Rank:
                                          type: number
                                          description: Degree of match to search criteria
                                        Type:
                                          type: string
                                          description: Internal data type of object returned
                                        ProviderName:
                                          type: array
                                          description: Array of strings, being the names of
                                            the Providers associated with the
                                            person
                                          items:
                                            type: string
                                        ProviderRefId:
                                          type: array
                                          description: Array of strings, being the
                                            ProviderRefIds of the Providers
                                            associated with the person
                                          items:
                                            type: string
                                        LocalId:
                                          type: string
                                          description: The StaffPersonalLocalId of the
                                            staff member located
                                        RefId:
                                          type: string
                                          description: The StaffPersonalRefId of the staff
                                            member located
                                        ESLPairwiseId:
                                          type: string
                                          description: Internal user provisioning
                                            identifier for the staff member
                                            located
                                        PersonInfo:
                                          type: object
                                          description: Partial PersonInfo object
                                          properties:
                                            Name:
                                              type: object
                                              description: Person name, in pieces and
                                                complete
                                              properties:
                                                Title:
                                                  type: string
                                                FamilyName:
                                                  type: string
                                                GivenName:
                                                  type: string
                                                MiddleName:
                                                  type: string
                                                PreferredGivenName:
                                                  type: string
                                                Suffix:
                                                  type: string
                                                FullName:
                                                  type: string
                                            Demographics:
                                              type: object
                                              properties:
                                                BirthDate:
                                                  type: string
                                                  format: date
                                            EmailList:
                                              type: object
                                              properties:
                                                Email:
                                                  type: object
                                                  properties:
                                                    Address:
                                                      type: string
                              StudentPersonals:
                                type: object
                                properties:
                                  StudentPersonal:
                                    type: array
                                    items:
                                      type: object
                                      properties:
                                        Name:
                                          type: string
                                          description: Full name from the search index
                                        Rank:
                                          type: number
                                          description: Degree of match to search criteria
                                        Type:
                                          type: string
                                          description: Internal data type of object returned
                                        ProviderName:
                                          type: array
                                          description: Array of strings, being the names of
                                            the Providers associated with the
                                            person
                                          items:
                                            type: string
                                        ProviderRefId:
                                          type: array
                                          description: Array of strings, being the
                                            ProviderRefIds of the Providers
                                            associated with the person
                                          items:
                                            type: string
                                        LocalId:
                                          type: string
                                          description: The StudentPersonalLocalId of the
                                            student located
                                        RefId:
                                          type: string
                                          description: The StudentPersonalRefId of the
                                            student located
                                        NationalStudentNumber:
                                          type: string
                                          description: The National Student Number of the
                                            student located
                                        PersonInfo:
                                          type: object
                                          description: Partial PersonInfo object
                                          properties:
                                            Name:
                                              type: object
                                              description: Person name, in pieces and
                                                complete
                                              properties:
                                                Title:
                                                  type: string
                                                FamilyName:
                                                  type: string
                                                GivenName:
                                                  type: string
                                                MiddleName:
                                                  type: string
                                                PreferredGivenName:
                                                  type: string
                                                Suffix:
                                                  type: string
                                                FullName:
                                                  type: string
                                            Demographics:
                                              type: object
                                              properties:
                                                BirthDate:
                                                  type: string
                                                  format: date
                                                Gender:
                                                  $ref: jsonSchema.NZ.create.yaml#/definitions/NZCodeSetsGender
                                            EmailList:
                                              type: object
                                              properties:
                                                Email:
                                                  type: object
                                                  properties:
                                                    Address:
                                                      type: string
components:
  securitySchemes:
    devt:
      type: http
      scheme: basic
      description: >-
        HTTP Basic authentication is only available on 'sandbox' edsby
        environments

        to facilitate development testing
    sifDataObject:
      type: http
      scheme: bearer
      bearerFormat: SIF Session Token
      description: >-
        HTTP Bearer authentication is applied to all SIF data objects; with the
        bearer token being the SIF Session Token

        that was returned by a call to the [SIF environment](#operation/createEnvironment) service.
  error:
    type: object
    title: error
    required:
      - error
      - when
      - errorstr
    additionalProperties: false
    properties:
      error:
        type: integer
        description: Edsby defined error code
      when:
        type: string
        format: date-time
        description: Date and Time of when the HTTP request was processed.
      errorstr:
        type: string
        description: Narrative text describing the error
      refId:
        type: string
        description: Data object refId of the object being created/updated
      localId:
        type: string
        description: Data object localId of the object being created/updated
  parameters:
    syncOverride:
      name: x-http-method-override
      in: header
<<<<<<< HEAD
      description: Rather than CREATE records, treat this request as a SYNC request.
      schema:
        type: string
        oneOf:
          - enum:
              - IncrSYNC
            title: Incremental Synchronise Request
            description: Add and Update records from the POST to ensure all records are
              present in the repository
          - enum:
              - FullSYNC
            title: Full Synchronise Request
            description: Add, Update and **Delete** records to ensure that ONLY those
              records are present in the repository
=======
  examples:
    Order:
      value:
        quantity: 1
        shipDate: '2018-10-19T16:46:45Z'
        status: placed
        complete: false
x-webhooks:
  newPet:
    post:
      summary: New pet
      description: Information about a new pet in the systems
      operationId: newPet
      tags: 
        - pet
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Pet"
      responses:
        "200":
          description: Return a 200 status to indicate that the data was received successfully
>>>>>>> master
